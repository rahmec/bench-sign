\doxysection{rng.\+h}
\hypertarget{rng_8h_source}{}\label{rng_8h_source}\index{/home/raximus/repos/work/speck/implementation/SPECK/repo/optimized/include/rng.h@{/home/raximus/repos/work/speck/implementation/SPECK/repo/optimized/include/rng.h}}
\mbox{\hyperlink{rng_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{parameters_8h}{parameters.h}}"{}}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{sha3_8h}{sha3.h}}"{}}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ <stddef.h>}}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00022\ \textcolor{comment}{/*\ initializes\ a\ CSPRNG,\ given\ the\ seed\ and\ a\ state\ pointer\ */}}
\DoxyCodeLine{00023\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{rng_8h_adc526129a5eb8bc803adf13bc5d72138}{initialize\_csprng}}(\mbox{\hyperlink{sha3_8h_adae9f13da8f3a47ecf60fc57d69be0d0}{SHAKE\_STATE\_STRUCT}}\ *shake\_state,}
\DoxyCodeLine{00024\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *seed,}
\DoxyCodeLine{00025\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ uint32\_t\ \mbox{\hyperlink{rng_8h_a5e333f6a68d1e8a63d33c5a8f08927ef}{seed\_len\_bytes}});}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00027\ \textcolor{comment}{/*\ initializes\ a\ CSPRNG,\ given\ the\ seed,\ a\ state\ pointer\ and\ a\ domain\ separation}}
\DoxyCodeLine{00028\ \textcolor{comment}{\ *\ constant\ */}}
\DoxyCodeLine{00029\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{rng_8h_a1a8f2acf1fd38dd37b4efc5651c0187d}{initialize\_csprng\_ds}}(\mbox{\hyperlink{sha3_8h_adae9f13da8f3a47ecf60fc57d69be0d0}{SHAKE\_STATE\_STRUCT}}\ *shake\_state,}
\DoxyCodeLine{00030\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *seed,}
\DoxyCodeLine{00031\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ uint32\_t\ \mbox{\hyperlink{rng_8h_a5e333f6a68d1e8a63d33c5a8f08927ef}{seed\_len\_bytes}},}
\DoxyCodeLine{00032\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ uint16\_t\ domain\_sep\_constant\ );}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00035\ \textcolor{comment}{/*\ extracts\ xlen\ bytes\ from\ the\ CSPRNG,\ given\ the\ state\ */}}
\DoxyCodeLine{00036\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}}
\DoxyCodeLine{00037\ \textcolor{keywordtype}{void}\ csprng\_randombytes(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *x,}
\DoxyCodeLine{00038\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{long}\ xlen,}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{sha3_8h_adae9f13da8f3a47ecf60fc57d69be0d0}{SHAKE\_STATE\_STRUCT}}\ *shake\_state)}
\DoxyCodeLine{00040\ \{}
\DoxyCodeLine{00041\ \ \ \ xof\_shake\_extract(shake\_state,\ x,\ xlen);}
\DoxyCodeLine{00042\ \}}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ \textcolor{comment}{/*\ global\ csprng\ state\ employed\ to\ have\ a\ deterministic\ randombytes\ for\ testing\ */}}
\DoxyCodeLine{00045\ \textcolor{keyword}{extern}\ \mbox{\hyperlink{sha3_8h_adae9f13da8f3a47ecf60fc57d69be0d0}{SHAKE\_STATE\_STRUCT}}\ \mbox{\hyperlink{rng_8h_a0a3ba30969b607063eaad589f3bb9195}{platform\_csprng\_state}};}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ \textcolor{comment}{/*\ extracts\ xlen\ bytes\ from\ the\ global\ CSPRNG\ */}}
\DoxyCodeLine{00048\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}}
\DoxyCodeLine{00049\ \textcolor{keywordtype}{void}\ randombytes(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *x,}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{long}\ xlen)}
\DoxyCodeLine{00051\ \{}
\DoxyCodeLine{00052\ \ \ \ xof\_shake\_extract(\&\mbox{\hyperlink{rng_8h_a0a3ba30969b607063eaad589f3bb9195}{platform\_csprng\_state}},\ x,\ xlen);}
\DoxyCodeLine{00053\ \}}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00056\ \mbox{\hyperlink{rng_8h_a76d91cc29d6e0a208c38ce19b8d765be}{\_\_attribute\_\_}}((unused))}
\DoxyCodeLine{00057\ \textcolor{keyword}{static}}
\DoxyCodeLine{00058\ \textcolor{keywordtype}{void}\ init\_randombytes(\textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *seed,}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{rng_8h_a5e333f6a68d1e8a63d33c5a8f08927ef}{seed\_len\_bytes}})}
\DoxyCodeLine{00060\ \{}
\DoxyCodeLine{00061\ \ \ \ \mbox{\hyperlink{rng_8h_adc526129a5eb8bc803adf13bc5d72138}{initialize\_csprng}}(\&\mbox{\hyperlink{rng_8h_a0a3ba30969b607063eaad589f3bb9195}{platform\_csprng\_state}},\ seed,\ \mbox{\hyperlink{rng_8h_a5e333f6a68d1e8a63d33c5a8f08927ef}{seed\_len\_bytes}});}
\DoxyCodeLine{00062\ \}}

\end{DoxyCode}
